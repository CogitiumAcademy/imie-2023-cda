{% extends 'base.html.twig' %}

{% block title %}Page test fiche{% endblock %}

{% block body %}

    {% for message in app.flashes('success') %}
        <div class="alert alert-success" role="alert">{{ message }}</div>
    {% endfor %}       

    {% for message in app.flashes('danger') %}
        <div class="alert alert-danger" role="alert">{{ message }}</div>
    {% endfor %}       

    <h2>{{ post.title }}</h2>
    <div>Rédigé par :  {{ post.user.displayName }}{# dump(post.user) #}</div>
    <div>Rangé dans : {{ post.category }}</div>
    <img src="{{ post.image }}" width="200">
    <div>{{ post.createdAt | ago }}</div>
    <div>{{ post.content | raw }}</div>

    <h2>Les commentaires</h2>
    
    {% if post.comments|length == 0 %}
        <div>Soyez le premier à commenter cet article !</div>
    {% else %}
        <ul>
            {% for comment in post.comments %}
                <li>
                    "{{ comment.content }}" écrit par {{ comment.user.displayName }} le {{ comment.createdAt|date }} 
                    {% if comment.user == app.user %}
                        <a href="{{ path('comment_delete', {id: comment.id}) }}" onclick="return confirm('Etes-vous certain ?')">Supprimer</a>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% endif %}

    {% if is_granted("ROLE_USER") %}

        {{ form(formu) }}

    {% endif %}

{% endblock %}
